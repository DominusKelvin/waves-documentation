# Валидация транзакции с помощью функцииsigVerify, без использования скрипта аккаунта

Перед тем как попасть в блок, каждая транзакция в блокчейне Waves проходит проверку на валидность.В функционал блокчейна Waves вшита функция sigVerify, которая выполняет проверку каждой транзакции на валидность:

```
sigVerify(signature, tx.bodyBytes(), pubKey)
```

где

**signature**— это цифровая подпись транзакции \(перед отправкой транзакции в блокчейн, владелец аккаунта, с которого транзакция отправляется, подписывает эту транзакцию своим закрытым ключом\),

**tx.bodyBytes\(\)**— это массив байт сериализованной транзакции,

**pubKey**— публичный ключ аккаунта, с которого отправляется транзакция.

Если функция sigVerify возвращает true, то транзакция попадает в блок, если функция возвращает false— транзакция отбрасывается блокчейном. Функция sigVerify проверяет только одну вещь— она проверяет то, что транзакция, отправляемая с некоторого аккаунта, была на самом деле отправлена владельцем этого аккаунта. Зная цифровую подпись транзакции и публичный ключ владельца аккаунта, принадлежность транзакции аккаунту легко проверить \(см. страницу шифрование публичным ключом\). И цифровая подпись, и публичный ключ прикладываются к транзакции.

# Валидация транзакции скриптом аккаунта {#id-Объяснениевалидациитранзакциискриптомаккаунта-Валидациятранзакциискриптомаккаунта}

В определенный момент в блокчейне Waves возникла необходимость создавать более сложные проверки транзакций на валидность. Например, было бы неплохо, чтобы транзакцию можно было бы подписывать не одним ключом, а, допустим, сразу несколькими ключами. Пример: Коля и Ваня являются партнерами, и они договорились, что транзакции с их общего аккаунта будут валидными, если они подписаны либо Колей, либо Ваней, либо Колей и Ваней одновременно.

Реализовать сложную логику проверки транзакций на валидность можно с помощью скрипта, написанного на языке RIDE.

Программист пишет на языке RIDE скрипт, компилирует его, и привязывает скомпилированный скрипт к аккаунту, с которого транзакция отправляется.

# Привязывание скрипта к аккаунту {#id-Объяснениевалидациитранзакциискриптомаккаунта-Привязываниескриптакаккаунту}

Привязывание скомпилированного скрипта к аккаунту производится с помощью специальной[Set Script-транзакции](https://docs.wavesplatform.com/en/waves-api-and-sdk/waves-node-rest-api/transactions.html#section-510c9bfa44d0430520a12c9113896f51).Данную транзакцию можно создать, например, с помощью [библиотечной функции](https://docs.wavesplatform.com/en/waves-api-and-sdk/client-libraries.html). Функция, создающая транзакцию, принимает на вход массив байт скомпилированного скрипта, и адрес аккаунта,с которого отправляется транзакция.

После привязывания скрипта к аккаунту, _любая _транзакция, которая будет отправляться с данного аккаунта, будет валидироваться данным скриптом.

При создании нового аккаунта, к этому аккаунту никакой скрипт еще не привязан. Поэтому все транзакции, которые отправляются с нового аккаунта, валидируются только функцией sigVerify, как описано выше.

После того, как к аккаунту привязывается скрипт, все отправляемый с данного аккаунта транзакции проверяются уже этим скриптом, а не функцией sigVerify. Тем не менее, внутри скрипта аккаунта разработчики часто используют функцию sigVerify.

К 1 аккаунту можно привязать только 1 скрипт.

# Перепривязывание скрипта к аккаунту {#id-Объяснениевалидациитранзакциискриптомаккаунта-Перепривязываниескриптакаккаунту}

Если владелец аккаунта, к которому привязан скрипт, захочет поменять логику, запрограммированную внутри скрипта, он должен будет сделать следующее:

1. Написать новую версию скрипта аккаунта, с обновленной логикой
2. Скомпилировать новый скрипт
3. Скомпилированный новый скрипт привязать к аккаунту

# Удаление привязки скрипта к аккаунту {#id-Объяснениевалидациитранзакциискриптомаккаунта-Удалениепривязкискриптакаккаунту}

С любого аккаунта, который имеет привязку к скрипту, данную привязку можно снять. После снятия привязки все транзакции, отправляемые с данного аккаунта, вновь будут валидироваться лишь функцией sigVerify.

# Пример простейшего скрипта аккаунта {#id-Объяснениевалидациитранзакциискриптомаккаунта-Примерпростейшегоскриптааккаунта}

В качестве IDE для написания скриптов на языке RIDE мы используем Waves IDE, доступное по адресу [http://ide.wavesplatform.com](http://ide.wavesplatform.com/).

Чтобы создать новый скрипт, кликнем на кнопку "New" и выберем пункт "Account Script".

